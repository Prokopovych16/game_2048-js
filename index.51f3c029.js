const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.state=t,this.board=t||this._generateEmptyBoard(),this.score=0,this.status="idle"}_generateEmptyBoard(){return[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=this.board[e],r=this._slideAndMerge(s);r.join("")!==s.join("")&&(t=!0),this.board[e]=r}t&&(this._addRandomTile(),this._checkGameStatus())}moveRight(){this.board=this.board.map(t=>t.reverse()),this.moveLeft(),this.board=this.board.map(t=>t.reverse())}moveUp(){this._transposeBoard(),this.moveLeft(),this._transposeBoard()}moveDown(){this._transposeBoard(),this.board=this.board.map(t=>t.reverse()),this.moveLeft(),this.board=this.board.map(t=>t.reverse()),this._transposeBoard()}_slideAndMerge(t){let e=t.filter(t=>t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);for(e=e.filter(t=>t);e.length<4;)e.push(0);return e}_transposeBoard(){let t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(let e=0;e<4;e++)for(let s=0;s<4;s++)t[e][s]=this.board[s][e];this.board=t}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.board=this._generateEmptyBoard(),this.score=0,this.status="playing",this._addRandomTile(),this._addRandomTile(),this._checkGameStatus()}restart(){this.start()}_addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(t.length>0){let e=t[Math.floor(Math.random()*t.length)];this.board[e.row][e.col]=.9>Math.random()?2:4}}_checkGameStatus(){this.board.some(t=>t.includes(2048))&&(this.status="win"),this._noMoreMoves()&&(this.status="lose")}_noMoreMoves(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return!1;return!0}};function e(){let e=t.getState();document.querySelectorAll(".field-cell").forEach((t,s)=>{let r=e[Math.floor(s/4)][s%4];t.textContent=r||"",t.className=`field-cell ${r?`field-cell--${r}`:""}`});let r=t.getStatus();document.querySelector(".message-win").classList.toggle("hidden","win"!==r),document.querySelector(".message-lose").classList.toggle("hidden","lose"!==r),document.querySelector(".message-start").classList.toggle("hidden","playing"===r);let o=document.querySelector(".button");o.removeEventListener("click",s),o.addEventListener("click",s),"playing"===r?(o.classList.remove("start"),o.classList.add("restart"),o.textContent="Restart"):(o.classList.remove("restart"),o.classList.add("start"),o.textContent="Start"),document.querySelector(".game-score").textContent=t.getScore()}function s(s){s.preventDefault(),"playing"===t.getStatus()?t.restart():t.start(),e()}document.addEventListener("keydown",s=>{switch(s.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}e()}),e();
//# sourceMappingURL=index.51f3c029.js.map
